/*!
 * Copyright © 2018 Splunk Inc.
 * SPLUNK CONFIDENTIAL – Use or disclosure of this material in whole or
 * in part without a valid written license from Splunk Inc. is PROHIBITED.
 */
(window["jsonp_splunk-assist-main"]=window["jsonp_splunk-assist-main"]||[]).push([[2],{2089:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var s=n(0),a=n.n(s),r=n(84);function l(e){return{activate:async(t,n)=>{try{if(!n)throw new r.a("POST","activate","assist/onboard",404);const s=await e.post("activate",{method:"POST",path:"assist/onboard",body:{code:t,license_id:n}});if("creating"===s.status||"active"===s.status)return{message:"Your account was successfully linked with your deployment",valid:!0}}catch(e){if(e instanceof r.a)return{code:e.status,valid:!1}}return{code:null,valid:!1}},getIsAssistEnabled:async()=>{var t,n,s,a;const r=await e.get("getOptinStatus",{method:"GET",path:"assist/optin_status"});return{connectivityOpen:null==(t=r.context)?void 0:t.network_connectivity,optinStatus:null==(n=r.context)?void 0:n.assist_optin,tenantStatus:null==(s=r.context)?void 0:s.tenant_status,assistEnabled:r.assist_enabled,sudOptinStatus:null==(a=r.context)?void 0:a.sud_optin}}}}var i=n(284),o=n(2157),u=n.n(o);function c(e){return{getLicenseGUID:async()=>{try{const t=await e.get("getLicenseInfo",{method:"GET",path:"licenser/localslave",queryParams:{output_mode:"json"}}),{content:n}=t.entry[0],s=u()(n.add_ons,(e,t)=>{var n;return null!=t&&null!=(n=t.parameters)&&n.guid&&e.push(t.parameters.guid),e},[]);return n.guid.filter(e=>!s.includes(e))[0].toLowerCase()}catch{return null}}}}function m(e){return{getAssistEnv:async()=>{try{const t=await e.get("getAssistEnv",{method:"GET",path:"properties/assist/cloud",queryParams:{output_mode:"json"}});return t.entry.find(e=>"scs_environment"===e.name).content}catch(e){return"production"}}}}function d(e){return{getCurrentContext:async()=>{try{const t=await e.get("getCurrentContext",{method:"GET",path:"authentication/current-context",queryParams:{output_mode:"json"}}),{content:n}=t.entry[0];return{username:null==n?void 0:n.username,email:null==n?void 0:n.email}}catch{return null}}}}const _=Object(s.createContext)(null),b=({children:e})=>{const t=Object(s.useMemo)(()=>(()=>{const e=new i.a({shouldUseSCS:!1});return{supervisorService:l(e),licenserService:c(e),confService:m(e),accessService:d(e)}})(),[]);return a.a.createElement(_.Provider,{value:t,__self:void 0,__source:{fileName:"/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/common/providers/ServiceProvider.tsx",lineNumber:20,columnNumber:12}},e)},f=()=>{const e=Object(s.useContext)(_);if(!e)throw new Error("useServices must be called within ServiceProvider");return e}},2112:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));const s="pending",a="running",r="completed"},2162:function(e,t){},2187:function(e,t,n){"use strict";n.r(t),n.d(t,"AssistRoutes",(function(){return je})),n.d(t,"AssistRouter",(function(){return we}));var s=n(23),a=n.n(s),r=n(0),l=n.n(r),i=n(107),o=n(3),u=n.n(o),c=n(208),m=n.n(c),d=n(87),_=n.n(d),b=n(4),f=n(2),N=n.n(f),v=n(33);function p(e,t){const n=Object(r.useRef)(),s=Object(r.useRef)(e);return Object(r.useEffect)(()=>{s.current=e},[e]),Object(r.useEffect)(()=>{const e=()=>s.current();if(null!==t)return n.current=window.setInterval(e,t),()=>window.clearInterval(n.current)},[t]),n}var g,E,S,O,k=n(206),h=n(10),A=n(5),y=n.n(A),j=n(20),w=n.n(j),T=n(43),I=n.n(T);const C=N.a.div(g||(g=u()(["\n    display: flex;\n    flex-flow: column;\n    align-content: center;\n    align-items: center;\n"]))),x=N()(w.a)(E||(E=u()(["\n    margin-top: ",";\n"])),y.a.spacingLarge),P=N()(w.a)(S||(S=u()(["\n    margin: 0;\n    color: ",";\n"])),y.a.contentColorDefault),L=N()(I.a)(O||(O=u()(["\n    font-size: ",";\n"])),y.a.fontSizeLarge);let R;!function(e){e[e.INITIAL=0]="INITIAL",e[e.OPT_IN=1]="OPT_IN",e[e.TENANT_CREATING=2]="TENANT_CREATING",e[e.COMPLETED=3]="COMPLETED"}(R||(R={}));const M={title:"Splunk Assist is loading",message:"Establishing secure connections..."},D=[{title:"Splunk Assist is loading",message:"Activating Splunk Assist...",altMessage:"This could take a few moments, stay tuned..."},{title:"Splunk Assist is loading",message:"Connecting to Splunk cloud services…"},{title:"Splunk Assist is loading",message:"Connected to Splunk cloud services.",altMessage:"Sending onboarding request..."},M];function G(e,t){switch(e){case R.INITIAL:return{title:"Splunk Assist is loading",message:"Activating Splunk Assist...",altMessage:"This could take a few moments, stay tuned..."};case R.OPT_IN:return function(e){return e>=D.length?M:D[e]}(t);case R.TENANT_CREATING:return{title:"Splunk Assist is loading",message:"Secure connections have been established.",altMessage:"Provisioning cloud resources..."};default:return{title:"Splunk Assist is loading",message:"Activating Splunk Assist...",altMessage:"This could take a few moments, stay tuned"}}}var z="/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/onboarding/components/AssistPendingActivation/AssistPendingActivation.tsx";function U(e,t,n){if(!n){if(t===h.e.UNKNOWN)return e===k.b.ENABLED?R.OPT_IN:R.INITIAL;if((t===h.e.CREATING||t===h.e.ACTIVE)&&e===k.b.ENABLED)return R.TENANT_CREATING}return t===h.e.ACTIVE&&n?R.COMPLETED:R.OPT_IN}const F=({reloadAssistContext:e})=>{const[t,n]=Object(r.useState)(0),[s,a]=Object(r.useState)(!1),{optinStatus:i,tenantStatus:o,assistEnabled:u}=Object(k.c)(),c=U(i,o,u),m=G(c,t);return p(e,5e3),p(()=>{c===R.OPT_IN&&t<D.length&&n(t+1)},2e4),p(()=>{a(!0)},18e4),l.a.createElement(C,{__self:void 0,__source:{fileName:z,lineNumber:95,columnNumber:9}},l.a.createElement(_.a,{size:"large",__self:void 0,__source:{fileName:z,lineNumber:96,columnNumber:13}}),l.a.createElement(x,{level:2,style:{color:"white"},__self:void 0,__source:{fileName:z,lineNumber:97,columnNumber:13}},null==m?void 0:m.title),l.a.createElement(P,{level:4,__self:void 0,__source:{fileName:z,lineNumber:100,columnNumber:13}},null==m?void 0:m.message),l.a.createElement(P,{level:4,__self:void 0,__source:{fileName:z,lineNumber:101,columnNumber:13}},null==m?void 0:m.altMessage),s&&l.a.createElement(l.a.Fragment,null,l.a.createElement("br",{__self:void 0,__source:{fileName:z,lineNumber:104,columnNumber:21}}),l.a.createElement(P,{level:4,__self:void 0,__source:{fileName:z,lineNumber:105,columnNumber:21}},"It looks like the activation is taking longer than expected."),l.a.createElement(P,{level:4,__self:void 0,__source:{fileName:z,lineNumber:108,columnNumber:21}},"If this persists,"," ",l.a.createElement(L,{to:Object(v.createDocsURL)("learnmore.splunkassist.overview"),openInNewContext:!0,__self:void 0,__source:{fileName:z,lineNumber:110,columnNumber:25}},"contact support"))))};var q=n(27),H=n.n(q),K=n(124),B=n(155),V=n(308),W="/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/onboarding/components/ActivationFailed.tsx";const X=()=>l.a.createElement(K.a,{"data-test":"activation-failed",__self:void 0,__source:{fileName:W,lineNumber:12,columnNumber:5}},l.a.createElement(V.a,{size:12,__self:void 0,__source:{fileName:W,lineNumber:13,columnNumber:9}}),l.a.createElement(B.c,{__self:void 0,__source:{fileName:W,lineNumber:14,columnNumber:9}},l.a.createElement(B.a,{level:2,__self:void 0,__source:{fileName:W,lineNumber:15,columnNumber:13}},"Activation Failed"),l.a.createElement(B.b,{__self:void 0,__source:{fileName:W,lineNumber:16,columnNumber:13}},"Something went wrong. Contact Splunk Support."),l.a.createElement(B.b,{__self:void 0,__source:{fileName:W,lineNumber:17,columnNumber:13}},l.a.createElement(H.a,{to:"https://www.splunk.com/en_us/about-splunk/contact-us.html#customer-support",appearance:"primary",openInNewContext:!0,__self:void 0,__source:{fileName:W,lineNumber:18,columnNumber:17}},"Contact Splunk Support"))));var J,Y,Q=n(13),Z=n(2112),$="/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/common/components/AssistApp.tsx";const ee=Object(r.lazy)(()=>n.e(5).then(n.bind(null,2188))),te=Object(r.lazy)(()=>Promise.all([n.e(3),n.e(4)]).then(n.bind(null,2186))),ne=()=>l.a.createElement(K.b,{"data-test":"loader",__self:void 0,__source:{fileName:$,lineNumber:27,columnNumber:5}},l.a.createElement(_.a,{size:"large",__self:void 0,__source:{fileName:$,lineNumber:28,columnNumber:9}})),se=N()(m.a)(J||(J=u()(["\n    margin-left: -",";\n    margin-right: -",";\n    margin-top: -",";\n    background-color: ",";\n"])),b.variables.spacingLarge,b.variables.spacingLarge,b.variables.spacingXSmall,b.variables.backgroundColorFloating),ae=N.a.div(Y||(Y=u()(["\n    overflow: auto;\n"])));const re=({context:e,isTest:t})=>{const{optinStatus:n,loadingState:s,reload:a,tenantStatus:i,assistEnabled:o}=Object(k.c)(),[u,c]=Object(r.useState)(sessionStorage.getItem("showGlobalMessage")||"true"),m=Object(r.useCallback)(()=>{sessionStorage.setItem("showGlobalMessage","false"),c("false")},[]),[d,_]=Object(r.useState)(sessionStorage.getItem("onboardingStateLocalStorageKey")||Z.b),b=e=>{sessionStorage.setItem("onboardingStateLocalStorageKey",e),_(e)};return Object(Q.a)(s)?l.a.createElement(ne,{__self:void 0,__source:{fileName:$,lineNumber:80,columnNumber:16}}):h.i.includes(i)?l.a.createElement(X,{__self:void 0,__source:{fileName:$,lineNumber:84,columnNumber:16}}):o&&n!==k.b.DISABLED||d===Z.a?function(e,t,n){return U(e,t,n)!==R.COMPLETED}(n,i,o)?l.a.createElement(K.b,{__self:void 0,__source:{fileName:$,lineNumber:105,columnNumber:13}},l.a.createElement(F,{reloadAssistContext:a,__self:void 0,__source:{fileName:$,lineNumber:106,columnNumber:17}})):l.a.createElement(r.Suspense,{fallback:l.a.createElement(ne,{__self:void 0,__source:{fileName:$,lineNumber:112,columnNumber:29}}),__self:void 0,__source:{fileName:$,lineNumber:112,columnNumber:9}},"true"===u&&l.a.createElement(se,{"data-test":"global-message",appearance:"banner",onRequestRemove:m,type:"info",__self:void 0,__source:{fileName:$,lineNumber:114,columnNumber:17}},"Indicator updates can take up to 1 hour to appear on this page."),l.a.createElement(ae,{__self:void 0,__source:{fileName:$,lineNumber:123,columnNumber:13}},l.a.createElement(ee,{context:e,isTest:t,__self:void 0,__source:{fileName:$,lineNumber:124,columnNumber:17}}))):l.a.createElement(r.Suspense,{fallback:l.a.createElement(ne,{__self:void 0,__source:{fileName:$,lineNumber:92,columnNumber:33}}),__self:void 0,__source:{fileName:$,lineNumber:92,columnNumber:13}},l.a.createElement(te,{context:e,isTest:t,onboardingState:d,onUpdateOnboarding:b,__self:void 0,__source:{fileName:$,lineNumber:93,columnNumber:17}}))};var le=n(311),ie=n(24),oe=n(2089);const ue=({children:e})=>{const t=function(){const e=Object(ie.useErrorHandler)(),{supervisorService:{getIsAssistEnabled:t}}=Object(oe.b)(),[n,s]=Object(r.useState)(0),{loadingState:a,value:l}=Object(Q.b)(e,"Error verifying Splunk Assist is enabled",t,{alwaysReset:!1,lastRefresh:n}),i=Object(r.useCallback)(()=>{s(e=>e<Number.MAX_SAFE_INTEGER-10?e+1:0)},[]);return Object(r.useMemo)(()=>({connectivityOpen:(null==l?void 0:l.connectivityOpen)||!1,loadingState:a,reload:i,optinStatus:(null==l?void 0:l.optinStatus)||k.b.UNKNOWN,tenantStatus:(null==l?void 0:l.tenantStatus)||"unknown",assistEnabled:(null==l?void 0:l.assistEnabled)||!1,sudOptinStatus:(null==l?void 0:l.sudOptinStatus)||!1}),[null==l?void 0:l.connectivityOpen,null==l?void 0:l.optinStatus,null==l?void 0:l.tenantStatus,a,i,null==l?void 0:l.assistEnabled,null==l?void 0:l.sudOptinStatus])}();return l.a.createElement(k.a.Provider,{value:t,__self:void 0,__source:{fileName:"/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/common/providers/Assist/AssistProvider.tsx",lineNumber:52,columnNumber:12}},e)};var ce=n(65),me=n(69);function de(e){if(e)return;const t=window.location.pathname;if(t){const e=t.split("/");if(e.length>0)return e.pop()||""}}var _e=n(67),be=n.n(_e),fe=n(2113),Ne=n(2163);const ve=["eventName"];var pe;!function(e){e.playground="play",e.production="prod",e.staging="stage"}(pe||(pe={}));const ge=e=>Object(r.useMemo)(()=>{const t=pe[e];if(void 0===t)return;const n=Object(fe.createTelemetry)(),s=Object(Ne.createSplunkOtelPlugin)({appType:"ec",appName:"splunk-assist-telemetry",environment:t,shouldRemovePII:!0});return n.addPlugin(s),n},[e]),Ee=(e,t)=>{let n="",s=e;for(;s;){var a;if(s.dataset.telemetryData){n=s.dataset.telemetryData;break}s=null==(a=s)?void 0:a.parentElement}if(n){const e=JSON.parse(n),{eventName:s}=e,a=be()(e,ve);if(!s)return;null==t||t.track(s,a)}},Se=(e,t)=>{(t||document).addEventListener("click",t=>Ee(t.target,e))};const Oe=Object(r.createContext)({}),ke=Oe.Provider;var he="/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/telemetry/TelemetryProvider.tsx";const Ae=({disableTelemetry:e,children:t})=>{const{confService:n,accessService:s}=Object(oe.b)(),[a,i]=Object(r.useState)(!1),o=Object(r.useRef)(null),u=Object(ie.useErrorHandler)(),c=Object(Q.b)(Object(r.useCallback)(()=>()=>{},[]),"Error loading current context",Object(r.useCallback)(()=>s.getCurrentContext(),[s])),m=Object(Q.b)(u,"Error loading assist environment info",Object(r.useCallback)(()=>n.getAssistEnv(),[n])),d=e?void 0:ge(m.value||"");return Object(r.useEffect)(()=>{var e;d&&!a&&null!=(e=c.value)&&e.email&&(d.identify({tenant:"",user:c.value.email}),Se(d,o.current),i(!0))},[d,c,i,a]),l.a.createElement(ke,{value:{telemetry:d},__self:void 0,__source:{fileName:he,lineNumber:57,columnNumber:9}},l.a.createElement("div",{ref:o,__self:void 0,__source:{fileName:he,lineNumber:58,columnNumber:13}},t))};var ye="/builds/swp/ui-platform/projects/remotes-splunk-assist/splunk-assist-main/src/ui/routers/AssistRouter.tsx";const je=({context:e,isTest:t})=>{const n=Object(i.useHistory)();return l.a.createElement(oe.a,{__self:void 0,__source:{fileName:ye,lineNumber:18,columnNumber:9}},l.a.createElement(me.a,{testFlags:{shouldUseSCS:!1,tenant:de(e.isSE)},__self:void 0,__source:{fileName:ye,lineNumber:19,columnNumber:13}},l.a.createElement(ce.a,{history:n,__self:void 0,__source:{fileName:ye,lineNumber:20,columnNumber:17}},l.a.createElement(le.a,{colorScheme:"dark",__self:void 0,__source:{fileName:ye,lineNumber:21,columnNumber:21}},l.a.createElement(Ae,{disableTelemetry:!0,__self:void 0,__source:{fileName:ye,lineNumber:22,columnNumber:25}},l.a.createElement(ue,{__self:void 0,__source:{fileName:ye,lineNumber:23,columnNumber:29}},l.a.createElement(re,{context:e,isTest:t,__self:void 0,__source:{fileName:ye,lineNumber:24,columnNumber:33}})))))))},we=e=>l.a.createElement(i.HashRouter,{__self:void 0,__source:{fileName:ye,lineNumber:36,columnNumber:9}},l.a.createElement(je,a()({},e,{__self:void 0,__source:{fileName:ye,lineNumber:37,columnNumber:13}})));t.default=we}}]);
//# sourceMappingURL=2.2.js.map?88b802be893f067318bb